<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=light data-auto-appearance=false><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><title>Fabric Madness: Feature Engineering with Dataflow Gen2 &#183; Data Simplicity</title>
<meta name=title content="Fabric Madness: Feature Engineering with Dataflow Gen2 &#183; Data Simplicity"><meta name=description content="In part 3 of this series we look again at feature engineering, this time with Dataflow Gen2; a low code data transformation and integration engine."><meta name=keywords content="Microsoft Fabric,Dataflow,"><link rel=canonical href=https://nobledynamic.github.io/posts/fabric-madness-3/><link type=text/css rel=stylesheet href=/css/main.bundle.min.5df62440e5b4837dcda2e55665cc9bad3ee1748c30cd928b8deea3c9cd2c5e716dbb602258b4df843a1a29155688a0d50d245816d46c48c0430d98eb00526528.css integrity="sha512-XfYkQOW0g33NouVWZcybrT7hdIwwzZKLje6jyc0sXnFtu2AiWLTfhDoaKRVWiKDVDSRYFtRsSMBDDZjrAFJlKA=="><script type=text/javascript src=/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj+e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.17ffe617e664d257760ee5f71869a6d9328d3613601c03a2eb7a194bbfb06ddc629a70f7b348e6e9446e81d0789555aebce09d27debd0329fc297601a1ee6a77.js integrity="sha512-F//mF+Zk0ld2DuX3GGmm2TKNNhNgHAOi63oZS7+wbdximnD3s0jm6URugdB4lVWuvOCdJ969Ayn8KXYBoe5qdw==" data-copy data-copied></script><script src=/js/zoom.min.js></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://nobledynamic.github.io/posts/fabric-madness-3/"><meta property="og:site_name" content="Data Simplicity"><meta property="og:title" content="Fabric Madness: Feature Engineering with Dataflow Gen2"><meta property="og:description" content="In part 3 of this series we look again at feature engineering, this time with Dataflow Gen2; a low code data transformation and integration engine."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-04-15T11:37:43+00:00"><meta property="article:modified_time" content="2024-04-15T11:37:43+00:00"><meta property="article:tag" content="Microsoft Fabric"><meta property="article:tag" content="Dataflow"><meta property="og:image" content="https://nobledynamic.github.io/posts/fabric-madness-3/feature.webp"><meta property="og:see_also" content="https://nobledynamic.github.io/posts/fabric-madness-4/"><meta property="og:see_also" content="https://nobledynamic.github.io/posts/fabric-madness-2/"><meta property="og:see_also" content="https://nobledynamic.github.io/posts/fabric-madness-1/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://nobledynamic.github.io/posts/fabric-madness-3/feature.webp"><meta name=twitter:title content="Fabric Madness: Feature Engineering with Dataflow Gen2"><meta name=twitter:description content="In part 3 of this series we look again at feature engineering, this time with Dataflow Gen2; a low code data transformation and integration engine."><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Blog","name":"Fabric Madness: Feature Engineering with Dataflow Gen2","headline":"Fabric Madness: Feature Engineering with Dataflow Gen2","abstract":"In part 3 of this series we look again at feature engineering, this time with Dataflow Gen2; a low code data transformation and integration engine.","inLanguage":"en","url":"https:\/\/nobledynamic.github.io\/posts\/fabric-madness-3\/","author":{"@type":"Person","name":""},"copyrightYear":"2024","dateCreated":"2024-04-15T11:37:43\u002b00:00","datePublished":"2024-04-15T11:37:43\u002b00:00","dateModified":"2024-04-15T11:37:43\u002b00:00","keywords":["Microsoft Fabric","Dataflow"],"mainEntityOfPage":"true","wordCount":"2555"}]</script><script src=/lib/jquery/jquery.slim.min.js integrity></script><meta name=theme-color></head><body class="flex flex-col h-screen m-auto text-lg leading-7 bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral" style=height:100%><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a></div><div class="fixed inset-x-0 pl-[24px] pr-[24px] bg-neutral dark:bg-neutral-800" style=z-index:100><div class="relative max-w-[64rem] ml-auto mr-auto"><div style=padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3"><div><a href=/ class=flex><span class=sr-only>Data Simplicity</span>
<img src=/img/noble-dynamic-logo.svg class="logo object-scale-down object-left nozoom fill-white" style=max-width:7rem alt="Data Simplicity"></a></div><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"></nav><nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12"><a href=/#services class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title>Services</p></a><a href=/posts/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title>Blog</p></a><a href=/#contact class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title>Contact</p></a><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title>
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button></nav><div class="flex md:hidden items-center space-x-5 md:ml-12 h-12"><span></span>
<button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title>
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button></div></div><div class="-my-2 -mr-2 md:hidden"><label id=menu-button for=menu-controller class=block><input type=checkbox id=menu-controller class=hidden><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper style=padding-top:5px class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl"><li><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/#services class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title>Services</p></a></li><li class=mt-1><a href=/posts/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title>Blog</p></a></li><li class=mt-1><a href=/#contact class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title>Contact</p></a></li></ul></div></label></div></div></div></div><div class="relative flex flex-col grow max-w-[64rem] ml-auto mr-auto sm:px-14 md:px-24 lg:px-32" style="padding:10rem 24px 0"><main id=main-content class=grow><article><div class="w-full h-36 md:h-56 lg:h-72 single_hero_basic nozoom" style=background-image:url(/posts/fabric-madness-3/feature.webp)></div><header id=single_header class="mt-5 max-w-prose"><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Fabric Madness: Feature Engineering with Dataflow Gen2</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime="2024-04-15 11:37:43 +0000 UTC">15 April 2024</time><span class="px-2 text-primary-500">&#183;</span><span>2555 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">12 mins</span></div><div class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/microsoft-fabric/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Microsoft Fabric
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/tags/dataflow/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Dataflow</span></span></span></div></div><div class="flex author"><div class=place-self-center><div class="text-2xl sm:text-lg"></div></div></div><div class="flex author author-extra mt-4"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width=96 height=96 src=/img/rogernoble_hu32b6729b8e72aa03a89d5108ed1ad3f8_17813_192x192_fill_q75_box_center.jpg><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><a href=https://nobledynamic.github.io//authors/rogernoble class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Roger Noble</a><div class="text-sm text-neutral-700 dark:text-neutral-400">Director</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://www.linkedin.com/in/roger-noble/ target=_blank aria-label=Linkedin rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://twitter.com/Roger_Noble target=_blank aria-label=X-Twitter rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://medium.com/@roger_noble target=_blank aria-label=Medium rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentcolor" d="M180.5 74.262C80.813 74.262.0 155.633.0 256S80.819 437.738 180.5 437.738 361 356.373 361 256 280.191 74.262 180.5 74.262zm288.25 10.646c-49.845.0-90.245 76.619-90.245 171.095s40.406 171.1 90.251 171.1 90.251-76.619 90.251-171.1H559C559 161.5 518.6 84.908 468.752 84.908zm139.506 17.821c-17.526.0-31.735 68.628-31.735 153.274s14.2 153.274 31.735 153.274S640 340.631 640 256c0-84.649-14.215-153.271-31.742-153.271z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/RogerNoble target=_blank aria-label=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://dev.to/rogernoble target=_blank aria-label=Dev rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M120.12 208.29c-3.88-2.9-7.77-4.35-11.65-4.35H91.03v104.47h17.45c3.88.0 7.77-1.45 11.65-4.35 3.88-2.9 5.82-7.25 5.82-13.06v-69.65c-.01-5.8-1.96-10.16-5.83-13.06zM404.1 32H43.9C19.7 32 .06 51.59.0 75.8v360.4C.06 460.41 19.7 480 43.9 480h360.2c24.21.0 43.84-19.59 43.9-43.8V75.8c-.06-24.21-19.7-43.8-43.9-43.8zM154.2 291.19c0 18.81-11.61 47.31-48.36 47.25h-46.4V172.98h47.38c35.44.0 47.36 28.46 47.37 47.28l.01 70.93zm100.68-88.66H201.6v38.42h32.57v29.57H201.6v38.41h53.29v29.57h-62.18c-11.16.29-20.44-8.53-20.72-19.69V193.7c-.27-11.15 8.56-20.41 19.71-20.69h63.19l-.01 29.52zm103.64 115.29c-13.2 30.75-36.85 24.63-47.44.0l-38.53-144.8h32.57l29.71 113.72 29.57-113.72h32.58l-38.46 144.8z"/></svg></span></span></a></div></div></div></div><div class=mb-5></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8"><div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-[140px]"><details open class="toc-right mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#what-is-dataflow-gen2>What is Dataflow Gen2?</a></li><li><a href=#the-challenge>The Challenge</a></li><li><a href=#the-no-code-approach>The no code approach</a><ul><li><a href=#the-data>The Data</a></li><li><a href=#loading-the-data>Loading the data</a></li><li><a href=#adding-features>Adding features</a></li></ul></li><li><a href=#the-low-code-approach>The low code approach</a><ul><li><a href=#loading-the-data-1>Loading the data</a></li></ul></li><li><a href=#the-all-code-approach>The all code approach</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#what-is-dataflow-gen2>What is Dataflow Gen2?</a></li><li><a href=#the-challenge>The Challenge</a></li><li><a href=#the-no-code-approach>The no code approach</a><ul><li><a href=#the-data>The Data</a></li><li><a href=#loading-the-data>Loading the data</a></li><li><a href=#adding-features>Adding features</a></li></ul></li><li><a href=#the-low-code-approach>The low code approach</a><ul><li><a href=#loading-the-data-1>Loading the data</a></li></ul></li><li><a href=#the-all-code-approach>The all code approach</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></details><script>(function(){var t,e=$("#TableOfContents");if(e.length>0){t=$(window);function n(){var s,o=t.scrollTop(),i=$(".anchor"),n="";if(i.each(function(e,t){t=$(t),t.offset().top-$(window).height()/3<=o&&(n=t.attr("id"))}),s=e.find("a.active"),s.length==1&&s.eq(0).attr("href")=="#"+n)return!0;s.each(function(e,t){$(t).removeClass("active")}),e.find('a[href="#'+n+'"]').addClass("active"),e.find('a[href="#'+n+'"]').parentsUntil("#TableOfContents").each(function(e,t){$(t).children("a").parents("ul").show()})}t.on("scroll",n),$(document).ready(function(){n()})}})()</script></div></div><div class="min-w-0 min-h-0 max-w-fit"><details style=margin-left:0 class="mt-2 mb-5 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5"><summary class="py-1 text-lg font-semibold cursor-pointer bg-primary-200 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-primary-800 dark:text-neutral-100">Fabric Madness - This article is part of a series.</summary><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><a href=https://nobledynamic.github.io/posts/fabric-madness-1/>Part 1: Fabric Madness: predicting basketball games with Microsoft Fabric</a></div><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><a href=https://nobledynamic.github.io/posts/fabric-madness-2/>Part 2: Fabric Madness: Feature Engineering with pyspark</a></div><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">Part 3: This Article</div><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><a href=https://nobledynamic.github.io/posts/fabric-madness-4/>Part 4: Fabric Madness: Experiments</a></div></details><div class="article-content max-w-prose mb-20"><p>In the previous post, we discussed how to use Notebooks with pyspark for feature engineering. While spark offers a lot of flexibility and power, it can be quite complex and requires a lot of code to get started. Not everyone is comfortable with writing code or has the time to learn a new programming language, which is where Dataflow Gen2 comes in.</p><h2 class="relative group">What is Dataflow Gen2?<div id=what-is-dataflow-gen2 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#what-is-dataflow-gen2 aria-label=Anchor>#</a></span></h2><p>Dataflow Gen2 is a low code data transformation and integration engine that allows you to create data pipelines for loading data from a wide variety of sources into Microsoft Fabric. It&rsquo;s based on Power Query, which is integrated into many Microsoft products, such as Excel, Power BI, and Azure Data Factory. Dataflow Gen2 is a great tool for creating data pipelines without code via a visual interface, making it easy to create data pipelines quickly. If you are already familiar with Power Query or are not afraid of writing code, you can also use the underlying M (&ldquo;Mashup&rdquo;) language to create more complex transformations.</p><p>In this post, we will walk through how to use Dataflow Gen2 to create the same features needed to train our machine learning model. We will use the same dataset as in the previous post, which contains data about college basketball games.</p><p><figure><img class="my-0 rounded-md" loading=lazy src=./images/final-dataflows.png alt="Final result"><figcaption>Fig. 1 - The final result</figcaption></figure></p><h2 class="relative group">The Challenge<div id=the-challenge class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#the-challenge aria-label=Anchor>#</a></span></h2><p>There are two datasets that we will be using to create our features: the regular season games and the tournament games. These two datasets are also split into the Men&rsquo;s and Women&rsquo;s tournaments, which will need to be combined into a single dataset. In total there are four csv files, that need to be combined and transformed into two separate tables in the Lakehouse.</p><p>Using Dataflows there are multiple ways to solve this problem, and in this post I want to show three different approaches: a no code approach, a low code approach and finally a more advanced all code approach.</p><h2 class="relative group">The no code approach<div id=the-no-code-approach class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#the-no-code-approach aria-label=Anchor>#</a></span></h2><p>The first and simplest approach is to use the Dataflow Gen2 visual interface to load the data and create the features.</p><h3 class="relative group">The Data<div id=the-data class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#the-data aria-label=Anchor>#</a></span></h3><p>The data we are looking at is from the 2024 US college basketball tournaments, which was obtained from the on-going March Machine Learning Mania 2024 Kaggle competition, the details of which can be found <a href="https://medium.com/r/?url=https%3A%2F%2Fwww.kaggle.com%2Fcompetitions%2Fmarch-machine-learning-mania-2024%2Foverview" target=_blank>here</a>, and is licensed under CC BY 4.0</p><h3 class="relative group">Loading the data<div id=loading-the-data class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#loading-the-data aria-label=Anchor>#</a></span></h3><p>The first step is to get the data from the Lakehouse, which can be done by selecting the &ldquo;Get Data&rdquo; button in the Home ribbon and then selecting <strong>More&mldr;</strong> from the list of data sources.</p><p><figure><img class="my-0 rounded-md" loading=lazy src=./images/get-data-more.png alt="Selecting the lakehouse as a source"><figcaption>Fig. 2 - Choosing a data source</figcaption></figure></p><p>From the list, select <strong>OneLake data hub</strong> to find the Lakehouse and then once selected, find the csv file in the Files folder.</p><p><figure><img class="my-0 rounded-md" loading=lazy src=./images/select-csv.png alt="Selecting the csv"><figcaption>Fig. 3 - Select the csv file</figcaption></figure></p><p>This will create a new query with four steps, which are:</p><ul><li>Source: A function that queries the Lakehouse for all the contents.</li><li>Navigation 1: Converts the contents of the Lakehouse into a table.</li><li>Navigation 2: Filters the table to retrieve the selected csv file by name.</li><li>Imported CSV: Converts the binary file into a table.</li></ul><p><figure><img class="my-0 rounded-md" loading=lazy src=./images/initial-load.png alt="Dataset in Power Query"><figcaption>Fig. 4 - Initial load</figcaption></figure></p><p>Now that the data is loaded we can start with some basic data preparation to get it into a format that we can use to create our features. The first thing we need to do is set the column names to be based on the first row of the dataset. This can be done by selecting the &ldquo;Use first row as headers&rdquo; option in either the Transform group on the Home ribbon or in the Transform menu item.</p><p>The next step is to rename the column &ldquo;WLoc&rdquo; to &ldquo;location&rdquo; by either selecting the column in the table view, or by right clicking on the column and selecting &ldquo;Rename&rdquo;.</p><p>The location column contains the location of the game, which is either &ldquo;H&rdquo; for home, &ldquo;A&rdquo; for away, or &ldquo;N&rdquo; for neutral. For our purposes, we want to convert this to a numerical value, where &ldquo;H&rdquo; is 1, &ldquo;A&rdquo; is -1, and &ldquo;N&rdquo; is 0, as this will make it easier to use in our model. This can be done by selecting the column and then using the <strong>Replace values&mldr;</strong> transform in the Transform menu item.</p><p><figure><img class="my-0 rounded-md" loading=lazy src=./images/replace-values.png alt="Replace Values"><figcaption>Fig. 5 - Replace Values</figcaption></figure></p><p>This will need to be done for the other two location values as well.</p><p>Finally, we need to change the data type of the location column to be a Whole number instead of Text. This can be done by selecting the column and then selecting the data type from the drop down list in the Transform group on the Home ribbon.</p><p><figure><img class="my-0 rounded-md" loading=lazy src=./images/final-data-load.png alt="Final data load"><figcaption>Fig. 6 - Final data load</figcaption></figure></p><p>Instead of repeating the rename step for each of the location types, a little bit of M code can be used to replace the values in the location column. This can be done by selecting the previous transform in the query (Renamed columns) and then selecting the Insert step button in the formula bar. This will add a new step, and you can enter the following code to replace the values in the location column.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-m data-lang=m><span class=line><span class=cl><span class=n>Table</span><span class=err>.</span><span class=n>ReplaceValue</span><span class=p>(</span><span class=nv>#</span><span class=s>&#34;Renamed columns&#34;</span><span class=p>,</span><span class=w> </span><span class=n>each</span><span class=w> </span><span class=p>[</span><span class=n>location</span><span class=p>],</span><span class=w> </span><span class=n>each</span><span class=w> </span><span class=n>if</span><span class=w> </span><span class=n>Text</span><span class=err>.</span><span class=n>Contains</span><span class=p>([</span><span class=n>location</span><span class=p>],</span><span class=w> </span><span class=s>&#34;H&#34;</span><span class=p>)</span><span class=w> </span><span class=n>then</span><span class=w> </span><span class=s>&#34;1&#34;</span><span class=w> </span><span class=n>else</span><span class=w> </span><span class=n>if</span><span class=w> </span><span class=n>Text</span><span class=err>.</span><span class=n>Contains</span><span class=p>([</span><span class=n>location</span><span class=p>],</span><span class=w> </span><span class=s>&#34;A&#34;</span><span class=p>)</span><span class=w> </span><span class=n>then</span><span class=w> </span><span class=s>&#34;-1&#34;</span><span class=w> </span><span class=n>else</span><span class=w> </span><span class=s>&#34;0&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Replacer</span><span class=err>.</span><span class=n>ReplaceText</span><span class=p>,</span><span class=w> </span><span class=p>{</span><span class=s>&#34;location&#34;</span><span class=p>})</span><span class=w>
</span></span></span></code></pre></div><h3 class="relative group">Adding features<div id=adding-features class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#adding-features aria-label=Anchor>#</a></span></h3><p>We&rsquo;ve got the data loaded, but it&rsquo;s still not right for our model. Each row in the dataset represents a game between two teams, and includes the scores and statistics for both the winning and losing team in a single wide table. We need to create features that represent the performance of each team in the game and to have a row per team per game.</p><p>To do this we need to split the data into two tables, one for the winning team and one for the losing team. The simplest way to do this is to create a new query for each team and then merge them back together at the end. There are a few ways that this could be done, however to keep things simple and understandable (especially if we ever need to come back to this later), we will create two references to the source query and then append them together again, after doing some light transformations.</p><p>Referencing a column can be done either from the Queries panel on the left, or by selecting the context menu of the query if using Diagram view. This will create a new query that references the original query, and any changes made to the original query will be reflected in the new query. I did this twice, once for the winning team and once for the losing team and then renamed the columns by prefixing them with &ldquo;T1_&rdquo; and &ldquo;T2_&rdquo; respectively.</p><p><figure><img class="my-0 rounded-md" loading=lazy src=./images/split-dataset.png alt=Split><figcaption>Fig. 7 - Split the dataset</figcaption></figure></p><p>Once the column values are set, we can then combine the two queries back together by using Append Queries and then create our first feature, which is the point difference between the two teams. This can be done by selecting the T1_Score and T2_Score columns and then selecting &ldquo;Subtract&rdquo; from the &ldquo;Standard&rdquo; group on the Add column ribbon.</p><p>Now that&rsquo;s done, we can then load the data into the Lakehouse as a new table. The final result should look something like this:</p><p><figure><img class="my-0 rounded-md" loading=lazy src=./images/finished-low-code.png alt="Joined together"><figcaption>Fig. 8 - All joined up</figcaption></figure></p><p>There are a few limitations with the no code approach, the main one is that it&rsquo;s not easy to reuse queries or transformations. In the above example we would need to repeat the same steps another three times to load each of the individual csv files. This is where copy / paste comes in handy, but it&rsquo;s not ideal. Let&rsquo;s look at a low code approach next.</p><h2 class="relative group">The low code approach<div id=the-low-code-approach class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#the-low-code-approach aria-label=Anchor>#</a></span></h2><p>In the low code approach we will use a combination of the visual interface and the M language to load and transform the data. This approach is more flexible than the no code approach, but still doesn&rsquo;t require a lot of code to be written.</p><h3 class="relative group">Loading the data<div id=loading-the-data-1 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#loading-the-data-1 aria-label=Anchor>#</a></span></h3><p>The goal of the low code approach is to reduce the number of repeated queries that are needed and to make it easier to reuse transformations. To do this we will take advantage of the fact that Power Query is a functional language and that we can create functions to encapsulate the transformations that we want to apply to the data. When we first loaded the data from the Lakehouse there were four steps that were created, the second step was to convert the contents of the Lakehouse into a table, with each row containing a reference to a binary csv file. We can use this as the input into a function, which will load the csv into a new table, using the Invoke custom function transformation for each row of the table.</p><p><figure><img class="my-0 rounded-md" loading=lazy src=./images/lakehouse-query.png alt="Lakehouse query"><figcaption>Fig. 9 - Lakehouse query with the binary csv files in a column called Content</figcaption></figure></p><p>To create the function, select &ldquo;Blank query&rdquo; from the Get data menu, or right click the Queries panel and select &ldquo;New query&rdquo; > &ldquo;Blank query&rdquo;. In the new query window, enter the following code:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-m data-lang=m><span class=line><span class=cl><span class=p>(</span><span class=n>TableContents</span><span class=w> </span><span class=n>as</span><span class=w> </span><span class=n>binary</span><span class=p>)</span><span class=w> </span><span class=o>=&gt;</span><span class=n>let</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>Source</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Csv</span><span class=err>.</span><span class=n>Document</span><span class=p>(</span><span class=n>TableContents</span><span class=p>,</span><span class=w> </span><span class=p>[</span><span class=n>Delimiter</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;,&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Columns</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>34</span><span class=p>,</span><span class=w> </span><span class=n>QuoteStyle</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>QuoteStyle</span><span class=err>.</span><span class=n>None</span><span class=p>]),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>PromoteHeaders</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Table</span><span class=err>.</span><span class=n>PromoteHeaders</span><span class=p>(</span><span class=n>Source</span><span class=p>,</span><span class=w> </span><span class=p>[</span><span class=n>PromoteAllScalars</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>true</span><span class=p>])</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>in</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>PromoteHeaders</span><span class=w>
</span></span></span></code></pre></div><p>The code of this function has been copied from our initial no code approach, but instead of loading the csv file directly, it takes a parameter called <strong>TableContents</strong>, reads it as a csv file <code>Csv.Document</code> and then sets the first row of the data to be the column headers <code>Table.PromoteHeaders</code>.</p><p>We can then use the Invoke custom function transformation to apply this function to each row of the Lakehouse query. This can be done by selecting the &ldquo;Invoke custom function&rdquo; transformation from the Add column ribbon and then selecting the function that we just created.</p><p><figure><img class="my-0 rounded-md" loading=lazy src=./images/invoke-custom-function.png alt="Invoke custom function"><figcaption>Fig. 10 - Invoke custom function</figcaption></figure></p><p>This will create a new column in the Lakehouse query, with the entire contents of the csv file loaded into a table, which is represented as <code>[Table]</code> in the table view. We can then use the expand function on the column heading to expand the table into individual columns.</p><p><figure><img class="my-0 rounded-md" loading=lazy src=./images/expand-columns.png alt="Expand columns"><figcaption>Fig. 11 - Expand columns</figcaption></figure></p><p>The result effectively combines the two csv files into a single table, which we can then continue to create our features from as before.</p><p>There are still some limitations with this approach, while we&rsquo;ve reduced the number of repeated queries, we still need to duplicate everything for both the regular season and tournament games datasets. This is where the all code approach comes in.</p><h2 class="relative group">The all code approach<div id=the-all-code-approach class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#the-all-code-approach aria-label=Anchor>#</a></span></h2><p>The all code approach is the most flexible and powerful approach, but also requires the most amount of code to be written. This approach is best suited for those who are comfortable with writing code and want to have full control over the transformations that are applied to the data.</p><p>Essentially what we&rsquo;ll do is grab all the M code that was generated in each of the queries and combine them into a single query. This will allow us to load all the csv files in a single query and then apply the transformations to each of them in a single step. To get all the M code, we can select each query and then click on the Advanced Editor from the Home ribbon, which displays all the M code that was generated for that query. We can then copy and paste this code into a new query and then combine them all together.</p><p>To do this, we need to create a new blank query and then enter the following code:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-m data-lang=m><span class=line><span class=cl><span class=p>(</span><span class=n>TourneyType</span><span class=w> </span><span class=n>as</span><span class=w> </span><span class=n>text</span><span class=p>)</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>let</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>Source</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Lakehouse</span><span class=err>.</span><span class=n>Contents</span><span class=p>(</span><span class=n>null</span><span class=p>){[</span><span class=n>workspaceId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;...&#34;</span><span class=p>]}[</span><span class=n>Data</span><span class=p>]{[</span><span class=n>lakehouseId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;...&#34;</span><span class=p>]}[</span><span class=n>Data</span><span class=p>],</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nv>#</span><span class=s>&#34;Navigation 1&#34;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Source</span><span class=p>{[</span><span class=n>Id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;Files&#34;</span><span class=p>,</span><span class=w> </span><span class=n>ItemKind</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;Folder&#34;</span><span class=p>]}[</span><span class=n>Data</span><span class=p>],</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nv>#</span><span class=s>&#34;Filtered rows&#34;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Table</span><span class=err>.</span><span class=n>SelectRows</span><span class=p>(</span><span class=nv>#</span><span class=s>&#34;Navigation 1&#34;</span><span class=p>,</span><span class=w> </span><span class=n>each</span><span class=w> </span><span class=n>Text</span><span class=err>.</span><span class=n>Contains</span><span class=p>([</span><span class=n>Name</span><span class=p>],</span><span class=w> </span><span class=n>TourneyType</span><span class=p>)),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nv>#</span><span class=s>&#34;Invoked custom function&#34;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Table</span><span class=err>.</span><span class=n>AddColumn</span><span class=p>(</span><span class=nv>#</span><span class=s>&#34;Filtered rows&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;Invoked custom function&#34;</span><span class=p>,</span><span class=w> </span><span class=n>each</span><span class=w> </span><span class=n>LoadCSV</span><span class=p>([</span><span class=n>Content</span><span class=p>])),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nv>#</span><span class=s>&#34;Removed columns&#34;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Table</span><span class=err>.</span><span class=n>RemoveColumns</span><span class=p>(</span><span class=nv>#</span><span class=s>&#34;Invoked custom function&#34;</span><span class=p>,</span><span class=w> </span><span class=p>{</span><span class=s>&#34;Content&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;Name&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;Extension&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;Date accessed&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;Date modified&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;Date created&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;Attributes&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;Folder Path&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;ItemKind&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;IsLeaf&#34;</span><span class=p>}),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nv>#</span><span class=s>&#34;Expanded Invoked custom function&#34;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Table</span><span class=err>.</span><span class=n>ExpandTableColumn</span><span class=p>(</span><span class=nv>#</span><span class=s>&#34;Removed columns&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;Invoked custom function&#34;</span><span class=p>,</span><span class=w> </span><span class=p>{</span><span class=s>&#34;Season&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;DayNum&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WTeamID&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WScore&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LTeamID&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LScore&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WLoc&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;NumOT&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WFGM&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WFGA&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WFGM3&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WFGA3&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WFTM&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WFTA&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WOR&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WDR&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WAst&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WTO&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WStl&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WBlk&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WPF&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LFGM&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LFGA&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LFGM3&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LFGA3&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LFTM&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LFTA&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LOR&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LDR&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LAst&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LTO&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LStl&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LBlk&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LPF&#34;</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;Season&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;DayNum&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WTeamID&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WScore&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LTeamID&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LScore&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WLoc&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;NumOT&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WFGM&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WFGA&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WFGM3&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WFGA3&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WFTM&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WFTA&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WOR&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WDR&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WAst&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WTO&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WStl&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WBlk&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;WPF&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LFGM&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LFGA&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LFGM3&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LFGA3&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LFTM&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LFTA&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LOR&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LDR&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LAst&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LTO&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LStl&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LBlk&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;LPF&#34;</span><span class=p>}),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nv>#</span><span class=s>&#34;Renamed columns&#34;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Table</span><span class=err>.</span><span class=n>RenameColumns</span><span class=p>(</span><span class=nv>#</span><span class=s>&#34;Expanded Invoked custom function&#34;</span><span class=p>,</span><span class=w> </span><span class=p>{{</span><span class=s>&#34;WLoc&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;location&#34;</span><span class=p>}}),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>Custom</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Table</span><span class=err>.</span><span class=n>ReplaceValue</span><span class=p>(</span><span class=nv>#</span><span class=s>&#34;Renamed columns&#34;</span><span class=p>,</span><span class=w> </span><span class=n>each</span><span class=w> </span><span class=p>[</span><span class=n>location</span><span class=p>],</span><span class=w> </span><span class=n>each</span><span class=w> </span><span class=n>if</span><span class=w> </span><span class=n>Text</span><span class=err>.</span><span class=n>Contains</span><span class=p>([</span><span class=n>location</span><span class=p>],</span><span class=w> </span><span class=s>&#34;H&#34;</span><span class=p>)</span><span class=w> </span><span class=n>then</span><span class=w> </span><span class=s>&#34;1&#34;</span><span class=w> </span><span class=n>else</span><span class=w> </span><span class=n>if</span><span class=w> </span><span class=n>Text</span><span class=err>.</span><span class=n>Contains</span><span class=p>([</span><span class=n>location</span><span class=p>],</span><span class=w> </span><span class=s>&#34;A&#34;</span><span class=p>)</span><span class=w> </span><span class=n>then</span><span class=w> </span><span class=s>&#34;-1&#34;</span><span class=w> </span><span class=n>else</span><span class=w> </span><span class=s>&#34;0&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Replacer</span><span class=err>.</span><span class=n>ReplaceText</span><span class=p>,</span><span class=w> </span><span class=p>{</span><span class=s>&#34;location&#34;</span><span class=p>}),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nv>#</span><span class=s>&#34;Change Types&#34;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Table</span><span class=err>.</span><span class=n>TransformColumnTypes</span><span class=p>(</span><span class=n>Custom</span><span class=p>,</span><span class=w> </span><span class=p>{{</span><span class=s>&#34;Season&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;DayNum&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;WTeamID&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;WScore&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;LTeamID&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;LScore&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;location&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;NumOT&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;WFGM&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;WFGA&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;WFGM3&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;WFGA3&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;WFTM&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;WFTA&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;WOR&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;WDR&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;WAst&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;WTO&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;WStl&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;WBlk&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;WPF&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;LFGM&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;LFGA&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;LFGM3&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;LFGA3&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;LFTM&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;LFTA&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;LOR&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;LDR&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;LAst&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;LTO&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;LStl&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;LBlk&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=s>&#34;LPF&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>}}),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>Winners</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Table</span><span class=err>.</span><span class=n>TransformColumnNames</span><span class=p>(</span><span class=nv>#</span><span class=s>&#34;Change Types&#34;</span><span class=p>,</span><span class=w> </span><span class=n>each</span><span class=w> </span><span class=n>if</span><span class=w> </span><span class=n>Text</span><span class=err>.</span><span class=n>StartsWith</span><span class=p>(</span><span class=nv>_</span><span class=p>,</span><span class=w> </span><span class=s>&#34;W&#34;</span><span class=p>)</span><span class=w> </span><span class=n>then</span><span class=w> </span><span class=n>Text</span><span class=err>.</span><span class=n>Replace</span><span class=p>(</span><span class=nv>_</span><span class=p>,</span><span class=w> </span><span class=s>&#34;W&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;T1_&#34;</span><span class=p>)</span><span class=w> </span><span class=n>else</span><span class=w> </span><span class=n>Text</span><span class=err>.</span><span class=n>Replace</span><span class=p>(</span><span class=nv>_</span><span class=p>,</span><span class=w> </span><span class=s>&#34;L&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;T2_&#34;</span><span class=p>)),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nv>#</span><span class=s>&#34;Rename L&#34;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Table</span><span class=err>.</span><span class=n>TransformColumnNames</span><span class=p>(</span><span class=nv>#</span><span class=s>&#34;Change Types&#34;</span><span class=p>,</span><span class=w> </span><span class=n>each</span><span class=w> </span><span class=n>if</span><span class=w> </span><span class=n>Text</span><span class=err>.</span><span class=n>StartsWith</span><span class=p>(</span><span class=nv>_</span><span class=p>,</span><span class=w> </span><span class=s>&#34;W&#34;</span><span class=p>)</span><span class=w> </span><span class=n>then</span><span class=w> </span><span class=n>Text</span><span class=err>.</span><span class=n>Replace</span><span class=p>(</span><span class=nv>_</span><span class=p>,</span><span class=w> </span><span class=s>&#34;W&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;T2_&#34;</span><span class=p>)</span><span class=w> </span><span class=n>else</span><span class=w> </span><span class=n>Text</span><span class=err>.</span><span class=n>Replace</span><span class=p>(</span><span class=nv>_</span><span class=p>,</span><span class=w> </span><span class=s>&#34;L&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;T1_&#34;</span><span class=p>)),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nv>#</span><span class=s>&#34;Replaced Value L&#34;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Table</span><span class=err>.</span><span class=n>ReplaceValue</span><span class=p>(</span><span class=nv>#</span><span class=s>&#34;Rename L&#34;</span><span class=p>,</span><span class=w> </span><span class=n>each</span><span class=w> </span><span class=p>[</span><span class=n>location</span><span class=p>],</span><span class=w> </span><span class=n>each</span><span class=w> </span><span class=n>if</span><span class=w> </span><span class=p>[</span><span class=n>location</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=n>then</span><span class=w> </span><span class=mi>-1</span><span class=w> </span><span class=n>else</span><span class=w> </span><span class=n>if</span><span class=w> </span><span class=n>Text</span><span class=err>.</span><span class=n>Contains</span><span class=p>([</span><span class=n>location</span><span class=p>],</span><span class=w> </span><span class=mi>-1</span><span class=p>)</span><span class=w> </span><span class=n>then</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=n>else</span><span class=w> </span><span class=p>[</span><span class=n>location</span><span class=p>],</span><span class=w> </span><span class=n>Replacer</span><span class=err>.</span><span class=n>ReplaceValue</span><span class=p>,</span><span class=w> </span><span class=p>{</span><span class=s>&#34;location&#34;</span><span class=p>}),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>Losers</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Table</span><span class=err>.</span><span class=n>TransformColumnTypes</span><span class=p>(</span><span class=nv>#</span><span class=s>&#34;Replaced Value L&#34;</span><span class=p>,</span><span class=w> </span><span class=p>{{</span><span class=s>&#34;location&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>}}),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>Combined</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Table</span><span class=err>.</span><span class=n>Combine</span><span class=p>({</span><span class=n>Winners</span><span class=p>,</span><span class=w> </span><span class=n>Losers</span><span class=p>}),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>PointDiff</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Table</span><span class=err>.</span><span class=n>AddColumn</span><span class=p>(</span><span class=n>Combined</span><span class=p>,</span><span class=w> </span><span class=s>&#34;PointDiff&#34;</span><span class=p>,</span><span class=w> </span><span class=n>each</span><span class=w> </span><span class=p>[</span><span class=nv>T1_Score</span><span class=p>]</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=p>[</span><span class=nv>T2_Score</span><span class=p>],</span><span class=w> </span><span class=n>Int64</span><span class=err>.</span><span class=n>Type</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>in</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>PointDiff</span><span class=w>
</span></span></span></code></pre></div><p><em>Note: the Lakehouse connection values have been removed</em></p><p>What&rsquo;s happening here is that we&rsquo;re:</p><ol><li>Loading the data from the Lakehouse;</li><li>Filtering the rows to only include the csv files that match the TourneyType parameter;</li><li>Loading the csv files into tables;</li><li>Expanding the tables into columns;</li><li>Renaming the columns;</li><li>Changing the data types;</li><li>Combining the two tables back together;</li><li>Calculating the point difference between the two teams.</li></ol><p>Using the query is then as simple as selecting it, and then invoking the function with the TourneyType parameter.</p><p><figure><img class="my-0 rounded-md" loading=lazy src=./images/invoke-function.png alt="Invoke function"><figcaption>Fig. 12 - Invoke function</figcaption></figure></p><p>This will create a new query with the function as it&rsquo;s source, and the data loaded and transformed. It&rsquo;s then just a case of loading the data into the Lakehouse as a new table.</p><p><figure><img class="my-0 rounded-md" loading=lazy src=./images/function-load.png alt="Funciton load"><figcaption>Fig. 13 - Function load</figcaption></figure></p><p>As you can see, the LoadTournamentData function is invoked with the parameter &ldquo;RegularSeasonDetailedResults&rdquo; which will load both the Men&rsquo;s and Women&rsquo;s regular season games into a single table.</p><h2 class="relative group">Conclusion<div id=conclusion class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#conclusion aria-label=Anchor>#</a></span></h2><p>And that&rsquo;s it!</p><p>Hopefully this post has given you a good overview of how to use Dataflow Gen2 to prepare data and create features for your machine learning model. Its low code approach makes it easy to create data pipelines quickly, and it contains a lot of powerful features that can be used to create complex transformations. It&rsquo;s a great first port of call for anyone who needs to transform data, but more importantly, has the benefit of not needing to write complex code that is prone to errors, is hard to test, and is difficult to maintain.</p><p>At the time of writing, Dataflows Gen2 are unsupported with the Git integration, and so it&rsquo;s not possible to version control or share the dataflows. This feature is expected to be <a href=https://learn.microsoft.com/en-us/fabric/release-plan/data-factory#git-df target=_blank>released in Q4 2024</a>.</p></div><details style=margin-left:0 class="mt-2 mb-5 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5"><summary class="py-1 text-lg font-semibold cursor-pointer bg-primary-200 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-primary-800 dark:text-neutral-100">Fabric Madness - This article is part of a series.</summary><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><a href=https://nobledynamic.github.io/posts/fabric-madness-1/>Part 1: Fabric Madness: predicting basketball games with Microsoft Fabric</a></div><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><a href=https://nobledynamic.github.io/posts/fabric-madness-2/>Part 2: Fabric Madness: Feature Engineering with pyspark</a></div><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">Part 3: This Article</div><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><a href=https://nobledynamic.github.io/posts/fabric-madness-4/>Part 4: Fabric Madness: Experiments</a></div></details></div><script>var oid="views_posts/fabric-madness-3/index.md",oid_likes="likes_posts/fabric-madness-3/index.md"</script><script type=text/javascript src=/js/page.min.b06a29d42a4ed16787978e2eee1e8c797b7698db2bc14ccee78f5c80ac566fc996190a73ad80a5e987558474b20b96fa38f7d85b405f165ff72b7b163c5ad11b.js integrity="sha512-sGop1CpO0WeHl44u7h6MeXt2mNsrwUzO549cgKxWb8mWGQpzrYCl6YdVhHSyC5b6OPfYW0BfFl/3K3sWPFrRGw=="></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="flex group mr-3" href=/posts/fabric-madness-2/><span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&larr;</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Fabric Madness: Feature Engineering with pyspark</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2024-04-08 09:37:43 +0000 UTC">8 April 2024</time>
</span></span></a></span><span><a class="flex text-right group ml-3" href=/posts/fabric-madness-4/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Fabric Madness: Experiments</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2024-04-22 11:38:43 +0000 UTC">22 April 2024</time>
</span></span><span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&larr;</span></a></span></div></div></footer></article><div id=top-scroller class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 px-4 print:hidden" style=padding-top:10rem><nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex flex-col list-none sm:flex-row"><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/terms-conditions/ title>Terms & Conditions</a></li><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/disclaimer/ title>Disclaimer</a></li><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=/privacy-policy/ title>Privacy</a></li><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=https://twitter.com/Roger_Noble title><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span></span></a></li><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=https://www.linkedin.com/company/noble-dynamic title><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></span></a></li><li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href=https://github.com/nobledynamic title><span><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span></a></li></ul></nav><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">© 2024 Noble Dynamic Limited</p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.62060bb247f4de2b6dde45903668fefb68d792f365587605177b1227c0cf43588701edaca0cb40e2c8e2789bd5ce67c1d2a215b9fb258c3496a7cd25e7cb5fdf.js integrity="sha512-YgYLskf03itt3kWQNmj++2jXkvNlWHYFF3sSJ8DPQ1iHAe2soMtA4sjieJvVzmfB0qIVufsljDSWp80l58tf3w=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]" data-url=https://nobledynamic.github.io/ style=z-index:500><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>